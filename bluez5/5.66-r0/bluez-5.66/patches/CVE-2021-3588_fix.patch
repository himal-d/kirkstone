Index: bluez-5.54/src/gatt-database.c
===================================================================
--- bluez-5.54.orig/src/gatt-database.c
+++ bluez-5.54/src/gatt-database.c
@@ -1082,6 +1082,12 @@ static void cli_feat_read_cb(struct gatt
 		goto done;
 	}
 
+
+	if (offset >= sizeof(state->cli_feat)) {
+		ecode = BT_ATT_ERROR_INVALID_OFFSET;
+		goto done;
+	}
+
 	len = sizeof(state->cli_feat) - offset;
 	value = len ? &state->cli_feat[offset] : NULL;
 
