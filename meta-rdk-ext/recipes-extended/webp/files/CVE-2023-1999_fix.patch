Date: Dec 2, 2023
From: srihariraghava_konduritirumala@comcast.com
Source: upstream
        https://github.com/webmproject/libwebp/commit/a486d800b60d0af4cc0836bf7ed8f21e12974129
Index: libwebp-0.5.0/src/enc/alpha.c
===================================================================
--- libwebp-0.5.0.orig/src/enc/alpha.c
+++ libwebp-0.5.0/src/enc/alpha.c
@@ -13,6 +13,7 @@
 
 #include <assert.h>
 #include <stdlib.h>
+#include <string.h>
 
 #include "./vp8enci.h"
 #include "../dsp/dsp.h"
@@ -142,6 +143,7 @@ static int EncodeAlphaInternal(const uin
       }
     } else {
       VP8LBitWriterWipeOut(&tmp_bw);
+      memset(&result->bw, 0, sizeof(result->bw));
       return 0;
     }
   }
@@ -156,7 +158,7 @@ static int EncodeAlphaInternal(const uin
   header = method | (filter << 2);
   if (reduce_levels) header |= ALPHA_PREPROCESSED_LEVELS << 4;
 
-  VP8BitWriterInit(&result->bw, ALPHA_HEADER_LEN + output_size);
+  if (!VP8BitWriterInit(&result->bw, ALPHA_HEADER_LEN + output_size)) ok = 0;
   ok = ok && VP8BitWriterAppend(&result->bw, &header, ALPHA_HEADER_LEN);
   ok = ok && VP8BitWriterAppend(&result->bw, output, output_size);
 
