Date:   Feb 8, 2024
From:   SrihariRaghava_konduritirumala@comcast.com
Source: upstream
        https://github.com/curl/curl/commit/8e21b1a05f3c0ee098dbcb6c

---
 lib/vssh/libssh2.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/lib/vssh/libssh2.c b/lib/vssh/libssh2.c
index c487cca..d8f4eb8 100644
--- a/lib/vssh/libssh2.c
+++ b/lib/vssh/libssh2.c
@@ -631,10 +631,12 @@ static CURLcode ssh_check_fingerprint(struct connectdata *conn)
    */
   if(pubkey_md5 && strlen(pubkey_md5) == 32) {
     if(!fingerprint || !strcasecompare(md5buffer, pubkey_md5)) {
-      if(fingerprint)
+      if(fingerprint){
         failf(data,
             "Denied establishing ssh session: mismatch md5 fingerprint. "
             "Remote %s is not equal to %s", md5buffer, pubkey_md5);
+	free(fingerprint);
+      }
       else
         failf(data,
             "Denied establishing ssh session: md5 fingerprint not available");
