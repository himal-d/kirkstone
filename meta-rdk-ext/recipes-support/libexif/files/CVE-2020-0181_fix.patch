Date: Sep 01, 2023
From: f6c54954cbfc25eb73d2d2902f0597c0220174a4%5E%21/#F0
Subject: Patch libexif to address CVE-2020-0181
Source: googlesource https://android.googlesource.com/platform/external/libexif/+/f6c54954cbfc25eb73d2d2902f0597c0220174a4%5E%21/#F0
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: libexif-0.6.21/libexif/exif-data.c
===================================================================
--- libexif-0.6.21.orig/libexif/exif-data.c
+++ libexif-0.6.21/libexif/exif-data.c
@@ -317,7 +317,10 @@ exif_data_load_data_thumbnail (ExifData
 			       unsigned int ds, ExifLong o, ExifLong s)
 {
 	/* Sanity checks */
-	if ((o + s < o) || (o + s < s) || (o + s > ds) || (o > ds)) {
+        uint64_t o64 = (uint64_t) o;
+        uint64_t s64 = (uint64_t) s;
+        uint64_t ds64 = (uint64_t) ds;
+        if ((o64 + s64) > ds64) {
 		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
 			  "Bogus thumbnail offset (%u) or size (%u).",
 			  o, s);
