Date: Sep 01, 2023
From: 0335ffc17f9b9a4831c242bb08ea92f605fde7a6%5E%21/#F0
Subject: Patch libexif to address CVE-2020-0093
Source: googlesource https://android.googlesource.com/platform/external/libexif/+/0335ffc17f9b9a4831c242bb08ea92f605fde7a6%5E%21/#F0
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: libexif-0.6.21/libexif/exif-data.c
===================================================================
--- libexif-0.6.21.orig/libexif/exif-data.c
+++ libexif-0.6.21/libexif/exif-data.c
@@ -302,7 +302,9 @@ exif_data_save_data_entry (ExifData *dat
 	/* Write the data. Fill unneeded bytes with 0. Do not crash with
 	 * e->data is NULL */
 	if (e->data) {
-		memcpy (*d + 6 + doff, e->data, s);
+                unsigned int len = s;
+                if (e->size < s) len = e->size;
+                memcpy (*d + 6 + doff, e->data, len);
 	} else {
 		memset (*d + 6 + doff, 0, s);
 	}
