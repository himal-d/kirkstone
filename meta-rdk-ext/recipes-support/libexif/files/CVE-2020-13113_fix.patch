Date: Sep 01, 2023
From: ec412aa4583ad71ecabb967d3c77162760169d1f
Subject: Patch libexif to address CVE-2020-13113
Source:  GITHUB https://github.com/libexif/libexif/commit/ec412aa4583ad71ecabb967d3c77162760169d1f
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: libexif-0.6.21/libexif/canon/exif-mnote-data-canon.c
===================================================================
--- libexif-0.6.21.orig/libexif/canon/exif-mnote-data-canon.c
+++ libexif-0.6.21/libexif/canon/exif-mnote-data-canon.c
@@ -240,6 +240,7 @@ exif_mnote_data_canon_load (ExifMnoteDat
 	for (i = c, o = datao; i; --i, o += 12) {
 		size_t s;
 
+                memset(&n->entries[tcount], 0, sizeof(MnoteCanonEntry));
                 if (CHECKOVERFLOW(o,buf_size,12)) {
 			exif_log (ne->log, EXIF_LOG_CODE_CORRUPT_DATA,
 				"ExifMnoteCanon", "Short MakerNote");
Index: libexif-0.6.21/libexif/fuji/exif-mnote-data-fuji.c
===================================================================
--- libexif-0.6.21.orig/libexif/fuji/exif-mnote-data-fuji.c
+++ libexif-0.6.21/libexif/fuji/exif-mnote-data-fuji.c
@@ -198,6 +198,7 @@ exif_mnote_data_fuji_load (ExifMnoteData
 	for (i = c, o = datao; i; --i, o += 12) {
 		size_t s;
 
+                memset(&n->entries[tcount], 0, sizeof(MnoteFujiEntry));
                 if (CHECKOVERFLOW(o, buf_size, 12)) {
 			exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
 				  "ExifMnoteDataFuji", "Short MakerNote");
Index: libexif-0.6.21/libexif/olympus/exif-mnote-data-olympus.c
===================================================================
--- libexif-0.6.21.orig/libexif/olympus/exif-mnote-data-olympus.c
+++ libexif-0.6.21/libexif/olympus/exif-mnote-data-olympus.c
@@ -434,6 +434,7 @@ exif_mnote_data_olympus_load (ExifMnoteD
 	for (i = c, o = o2; i; --i, o += 12) {
 		size_t s;
 
+                memset(&n->entries[tcount], 0, sizeof(MnoteOlympusEntry));
                 if (CHECKOVERFLOW(o, buf_size, 12)) {
 			exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
 				  "ExifMnoteOlympus", "Short MakerNote");
Index: libexif-0.6.21/libexif/pentax/exif-mnote-data-pentax.c
===================================================================
--- libexif-0.6.21.orig/libexif/pentax/exif-mnote-data-pentax.c
+++ libexif-0.6.21/libexif/pentax/exif-mnote-data-pentax.c
@@ -280,6 +280,7 @@ exif_mnote_data_pentax_load (ExifMnoteDa
 	for (i = c, o = datao; i; --i, o += 12) {
 		size_t s;
 
+                memset(&n->entries[tcount], 0, sizeof(MnotePentaxEntry));
                 if (CHECKOVERFLOW(o,buf_size,12)) {
 			exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
 				  "ExifMnoteDataPentax", "Short MakerNote");
