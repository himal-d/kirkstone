From ec463d67fa20962f218ad6bd299d71350c300d91 Feb 03 00:00:00 2001
From: Vadym Omelchuk <vomelchuk@maxlinear.com>
Date: Tue, 03 Feb 2020 15:16:41 +0000
Subject: RDKB-34150 : Porting systemd and busybox to XB6 Y3.1
Source: Intel
License: GPLV2
Upstream-Status: Pending
Reason for change: Bring puma-oss and puma-oss-ported to XB6
Test procedure: Build and verify.
Risk: Low
Signed-off-by: Vadym Omelchuk <vomelchuk@maxlinear.com>
Index: bash-3.2.57/builtins/pushd.def
===================================================================
--- bash-3.2.57.orig/builtins/pushd.def
+++ bash-3.2.57/builtins/pushd.def
@@ -333,7 +333,7 @@ popd_builtin (list)
 	break;
     }
 
-  if (which > directory_list_offset || (directory_list_offset == 0 && which == 0))
+  if (which > directory_list_offset || (which < -directory_list_offset) || (directory_list_offset == 0 && which == 0))
     {
       pushd_error (directory_list_offset, which_word ? which_word : "");
       return (EXECUTION_FAILURE);
@@ -355,6 +355,11 @@ popd_builtin (list)
 	 remove that directory from the list and shift the remainder
 	 of the list into place. */
       i = (direction == '+') ? directory_list_offset - which : which;
+      if (i < 0 || i > directory_list_offset)
+	{
+	  pushd_error (directory_list_offset, which_word ? which_word : "");
+	  return (EXECUTION_FAILURE);
+	}
       free (pushd_directory_list[i]);
       directory_list_offset--;
 
